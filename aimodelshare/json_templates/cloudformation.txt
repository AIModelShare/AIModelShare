{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Creation of Policies, Roles, Lambda",
    "Parameters": {
        "PolicyDocument": {
            "Type": "Json"
        },
        "PolicyName": {
            "Type": "String"
        },
        "TrustPolicy": {
            "Type": "Json"
        },
        "Policies": {
            "Type": "List",
            "Default": ["${PolicyName}"]
        },
        "RoleName": {
            "Type": "String"
        },
        "Code": {
            "Type": "Json"
        },
        "Environment": {
            "Type": "Json"
        },
        "FunctionName": {
            "Type": "String
        },
        "MemorySize": {
            "Type": "Integer"
        },
        "PackageType": {
            "Type": "String"
        },
        "Timeout": {
            "Type": "Integer"
        }
    },
    "Resources": {
        "Policy": {
            "Type" : "AWS::IAM::Policy",
            "Properties" : {
                "PolicyDocument" : "${PolicyDocument}",
                "PolicyName" : "${PolicyName}"
            }
        },
        "Role": {
            "Type" : "AWS::IAM::Role",
            "Properties" : {
                "AssumeRolePolicyDocument" : "${TrustPolicy}",
                "Policies" : "${Policies}",
                "RoleName" : "${RoleName}"
            }
        },
        "Lambda": {
            "Type" : "AWS::Lambda::Function",
            "Properties" : {
                "Code" : "${Code},
                "Environment" : "${Environment}",
                "FunctionName" : "${FunctionName}",
                "MemorySize" : "${MemorySize}",
                "PackageType" : "${PackageType}",
                "Role" : "${Role.Arn}",
                "Timeout" : "${Timeout}",
            }
        }
    }
}